"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8255],{8255:(Le,H,b)=>{b.r(H),b.d(H,{ProfilePageModule:()=>ge});var G=b(177),Z=b(4341),g=b(9465),B=b(8986),c=b(467),s=b(3953);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var O=function(n){return n.Unimplemented="UNIMPLEMENTED",n.Unavailable="UNAVAILABLE",n}(O||{});class A extends Error{constructor(e,r,t){super(e),this.message=e,this.code=r,this.data=t}}const ne=n=>{var e,r,t,o,i;const l=n.CapacitorCustomPlatform||null,a=n.Capacitor||{},u=a.Plugins=a.Plugins||{},d=n.CapacitorPlatforms,L=(null===(e=null==d?void 0:d.currentPlatform)||void 0===e?void 0:e.getPlatform)||(()=>null!==l?l.name:(n=>{var e,r;return null!=n&&n.androidBridge?"android":null!==(r=null===(e=null==n?void 0:n.webkit)||void 0===e?void 0:e.messageHandlers)&&void 0!==r&&r.bridge?"ios":"web"})(n)),Pe=(null===(r=null==d?void 0:d.currentPlatform)||void 0===r?void 0:r.isNativePlatform)||(()=>"web"!==L()),be=(null===(t=null==d?void 0:d.currentPlatform)||void 0===t?void 0:t.isPluginAvailable)||(f=>{const p=T.get(f);return!!(null!=p&&p.platforms.has(L())||J(f))}),J=(null===(o=null==d?void 0:d.currentPlatform)||void 0===o?void 0:o.getPluginHeader)||(f=>{var p;return null===(p=a.PluginHeaders)||void 0===p?void 0:p.find(I=>I.name===f)}),T=new Map,Ee=(null===(i=null==d?void 0:d.currentPlatform)||void 0===i?void 0:i.registerPlugin)||((f,p={})=>{const I=T.get(f);if(I)return console.warn(`Capacitor plugin "${f}" already registered. Cannot register plugins twice.`),I.proxy;const E=L(),x=J(f);let w;const ke=function(){var m=(0,c.A)(function*(){return!w&&E in p?w=w="function"==typeof p[E]?yield p[E]():p[E]:null!==l&&!w&&"web"in p&&(w=w="function"==typeof p.web?yield p.web():p.web),w});return function(){return m.apply(this,arguments)}}(),W=m=>{let h;const v=(...y)=>{const _=ke().then(P=>{const k=((m,h)=>{var v,y;if(!x){if(m)return null===(y=m[h])||void 0===y?void 0:y.bind(m);throw new A(`"${f}" plugin is not implemented on ${E}`,O.Unimplemented)}{const _=null==x?void 0:x.methods.find(P=>h===P.name);if(_)return"promise"===_.rtype?P=>a.nativePromise(f,h.toString(),P):(P,k)=>a.nativeCallback(f,h.toString(),P,k);if(m)return null===(v=m[h])||void 0===v?void 0:v.bind(m)}})(P,m);if(k){const R=k(...y);return h=null==R?void 0:R.remove,R}throw new A(`"${f}.${m}()" is not implemented on ${E}`,O.Unimplemented)});return"addListener"===m&&(_.remove=(0,c.A)(function*(){return h()})),_};return v.toString=()=>`${m.toString()}() { [capacitor code] }`,Object.defineProperty(v,"name",{value:m,writable:!1,configurable:!1}),v},Q=W("addListener"),N=W("removeListener"),Ue=(m,h)=>{const v=Q({eventName:m},h),y=function(){var P=(0,c.A)(function*(){const k=yield v;N({eventName:m,callbackId:k},h)});return function(){return P.apply(this,arguments)}}(),_=new Promise(P=>v.then(()=>P({remove:y})));return _.remove=(0,c.A)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield y()}),_},D=new Proxy({},{get(m,h){switch(h){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return x?Ue:Q;case"removeListener":return N;default:return W(h)}}});return u[f]=D,T.set(f,{name:f,proxy:D,platforms:new Set([...Object.keys(p),...x?[E]:[]])}),D});return a.convertFileSrc||(a.convertFileSrc=f=>f),a.getPlatform=L,a.handleError=f=>n.console.error(f),a.isNativePlatform=Pe,a.isPluginAvailable=be,a.pluginMethodNoop=(f,p,I)=>Promise.reject(`${I} does not have an implementation of "${p}".`),a.registerPlugin=Ee,a.Exception=A,a.DEBUG=!!a.DEBUG,a.isLoggingEnabled=!!a.isLoggingEnabled,a.platform=a.getPlatform(),a.isNative=a.isNativePlatform(),a},j=(n=>n.Capacitor=ne(n))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),S=j.registerPlugin;class ${constructor(e){this.listeners={},this.retainedEventArguments={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,r){var t=this;let o=!1;this.listeners[e]||(this.listeners[e]=[],o=!0),this.listeners[e].push(r);const l=this.windowListeners[e];l&&!l.registered&&this.addWindowListener(l),o&&this.sendRetainedArgumentsForEvent(e);const a=function(){var d=(0,c.A)(function*(){return t.removeListener(e,r)});return function(){return d.apply(this,arguments)}}();return Promise.resolve({remove:a})}removeAllListeners(){var e=this;return(0,c.A)(function*(){e.listeners={};for(const r in e.windowListeners)e.removeWindowListener(e.windowListeners[r]);e.windowListeners={}})()}notifyListeners(e,r,t){const o=this.listeners[e];if(o)o.forEach(i=>i(r));else if(t){let i=this.retainedEventArguments[e];i||(i=[]),i.push(r),this.retainedEventArguments[e]=i}}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,r){this.windowListeners[r]={registered:!1,windowEventName:e,pluginEventName:r,handler:t=>{this.notifyListeners(r,t)}}}unimplemented(e="not implemented"){return new j.Exception(e,O.Unimplemented)}unavailable(e="not available"){return new j.Exception(e,O.Unavailable)}removeListener(e,r){var t=this;return(0,c.A)(function*(){const o=t.listeners[e];if(!o)return;const i=o.indexOf(r);t.listeners[e].splice(i,1),t.listeners[e].length||t.removeWindowListener(t.windowListeners[e])})()}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const r=this.retainedEventArguments[e];r&&(delete this.retainedEventArguments[e],r.forEach(t=>{this.notifyListeners(e,t)}))}}const q=n=>encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),K=n=>n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class oe extends ${getCookies(){return(0,c.A)(function*(){const e=document.cookie,r={};return e.split(";").forEach(t=>{if(t.length<=0)return;let[o,i]=t.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");o=K(o).trim(),i=K(i).trim(),r[o]=i}),r})()}setCookie(e){return(0,c.A)(function*(){try{const r=q(e.key),t=q(e.value),o=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),l=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${r}=${t||""}${o}; path=${i}; ${l};`}catch(r){return Promise.reject(r)}})()}deleteCookie(e){return(0,c.A)(function*(){try{document.cookie=`${e.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}})()}clearCookies(){return(0,c.A)(function*(){try{const e=document.cookie.split(";")||[];for(const r of e)document.cookie=r.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}})()}clearAllCookies(){var e=this;return(0,c.A)(function*(){try{yield e.clearCookies()}catch(r){return Promise.reject(r)}})()}}S("CapacitorCookies",{web:()=>new oe});const ie=function(){var n=(0,c.A)(function*(e){return new Promise((r,t)=>{const o=new FileReader;o.onload=()=>{const i=o.result;r(i.indexOf(",")>=0?i.split(",")[1]:i)},o.onerror=i=>t(i),o.readAsDataURL(e)})});return function(r){return n.apply(this,arguments)}}();class ce extends ${request(e){return(0,c.A)(function*(){const r=((n,e={})=>{const r=Object.assign({method:n.method||"GET",headers:n.headers},e),o=((n={})=>{const e=Object.keys(n);return Object.keys(n).map(o=>o.toLocaleLowerCase()).reduce((o,i,l)=>(o[i]=n[e[l]],o),{})})(n.headers)["content-type"]||"";if("string"==typeof n.data)r.body=n.data;else if(o.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[l,a]of Object.entries(n.data||{}))i.set(l,a);r.body=i.toString()}else if(o.includes("multipart/form-data")||n.data instanceof FormData){const i=new FormData;if(n.data instanceof FormData)n.data.forEach((a,u)=>{i.append(u,a)});else for(const a of Object.keys(n.data))i.append(a,n.data[a]);r.body=i;const l=new Headers(r.headers);l.delete("content-type"),r.headers=l}else(o.includes("application/json")||"object"==typeof n.data)&&(r.body=JSON.stringify(n.data));return r})(e,e.webFetchExtra),t=((n,e=!0)=>n?Object.entries(n).reduce((t,o)=>{const[i,l]=o;let a,u;return Array.isArray(l)?(u="",l.forEach(d=>{a=e?encodeURIComponent(d):d,u+=`${i}=${a}&`}),u.slice(0,-1)):(a=e?encodeURIComponent(l):l,u=`${i}=${a}`),`${t}&${u}`},"").substr(1):null)(e.params,e.shouldEncodeUrlParams),o=t?`${e.url}?${t}`:e.url,i=yield fetch(o,r),l=i.headers.get("content-type")||"";let u,d,{responseType:a="text"}=i.ok?e:{};switch(l.includes("application/json")&&(a="json"),a){case"arraybuffer":case"blob":d=yield i.blob(),u=yield ie(d);break;case"json":u=yield i.json();break;default:u=yield i.text()}const C={};return i.headers.forEach((L,M)=>{C[M]=L}),{data:u,headers:C,status:i.status,url:i.url}})()}get(e){var r=this;return(0,c.A)(function*(){return r.request(Object.assign(Object.assign({},e),{method:"GET"}))})()}post(e){var r=this;return(0,c.A)(function*(){return r.request(Object.assign(Object.assign({},e),{method:"POST"}))})()}put(e){var r=this;return(0,c.A)(function*(){return r.request(Object.assign(Object.assign({},e),{method:"PUT"}))})()}patch(e){var r=this;return(0,c.A)(function*(){return r.request(Object.assign(Object.assign({},e),{method:"PATCH"}))})()}delete(e){var r=this;return(0,c.A)(function*(){return r.request(Object.assign(Object.assign({},e),{method:"DELETE"}))})()}}S("CapacitorHttp",{web:()=>new ce});var U=function(n){return n.Prompt="PROMPT",n.Camera="CAMERA",n.Photos="PHOTOS",n}(U||{}),F=function(n){return n.Rear="REAR",n.Front="FRONT",n}(F||{}),z=function(n){return n.Uri="uri",n.Base64="base64",n.DataUrl="dataUrl",n}(z||{});class X extends ${getPhoto(e){var r=this;return(0,c.A)(function*(){return new Promise(function(){var t=(0,c.A)(function*(o,i){if(e.webUseInput||e.source===U.Photos)r.fileInputExperience(e,o,i);else if(e.source===U.Prompt){let l=document.querySelector("pwa-action-sheet");l||(l=document.createElement("pwa-action-sheet"),document.body.appendChild(l)),l.header=e.promptLabelHeader||"Photo",l.cancelable=!1,l.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],l.addEventListener("onSelection",function(){var a=(0,c.A)(function*(u){0===u.detail?r.fileInputExperience(e,o,i):r.cameraExperience(e,o,i)});return function(u){return a.apply(this,arguments)}}())}else r.cameraExperience(e,o,i)});return function(o,i){return t.apply(this,arguments)}}())})()}pickImages(e){var r=this;return(0,c.A)(function*(){return new Promise(function(){var t=(0,c.A)(function*(o,i){r.multipleFileInputExperience(o,i)});return function(o,i){return t.apply(this,arguments)}}())})()}cameraExperience(e,r,t){var o=this;return(0,c.A)(function*(){if(customElements.get("pwa-camera-modal")){const i=document.createElement("pwa-camera-modal");i.facingMode=e.direction===F.Front?"user":"environment",document.body.appendChild(i);try{yield i.componentOnReady(),i.addEventListener("onPhoto",function(){var l=(0,c.A)(function*(a){const u=a.detail;null===u?t(new A("User cancelled photos app")):u instanceof Error?t(u):r(yield o._getCameraPhoto(u,e)),i.dismiss(),document.body.removeChild(i)});return function(a){return l.apply(this,arguments)}}()),i.present()}catch{o.fileInputExperience(e,r,t)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),o.fileInputExperience(e,r,t)})()}fileInputExperience(e,r,t){let o=document.querySelector("#_capacitor-camera-input");const i=()=>{var l;null===(l=o.parentNode)||void 0===l||l.removeChild(o)};o||(o=document.createElement("input"),o.id="_capacitor-camera-input",o.type="file",o.hidden=!0,document.body.appendChild(o),o.addEventListener("change",l=>{const a=o.files[0];let u="jpeg";if("image/png"===a.type?u="png":"image/gif"===a.type&&(u="gif"),"dataUrl"===e.resultType||"base64"===e.resultType){const d=new FileReader;d.addEventListener("load",()=>{if("dataUrl"===e.resultType)r({dataUrl:d.result,format:u});else if("base64"===e.resultType){const C=d.result.split(",")[1];r({base64String:C,format:u})}i()}),d.readAsDataURL(a)}else r({webPath:URL.createObjectURL(a),format:u}),i()}),o.addEventListener("cancel",l=>{t(new A("User cancelled photos app")),i()})),o.accept="image/*",o.capture=!0,e.source===U.Photos||e.source===U.Prompt?o.removeAttribute("capture"):e.direction===F.Front?o.capture="user":e.direction===F.Rear&&(o.capture="environment"),o.click()}multipleFileInputExperience(e,r){let t=document.querySelector("#_capacitor-camera-input-multiple");const o=()=>{var i;null===(i=t.parentNode)||void 0===i||i.removeChild(t)};t||(t=document.createElement("input"),t.id="_capacitor-camera-input-multiple",t.type="file",t.hidden=!0,t.multiple=!0,document.body.appendChild(t),t.addEventListener("change",i=>{const l=[];for(let a=0;a<t.files.length;a++){const u=t.files[a];let d="jpeg";"image/png"===u.type?d="png":"image/gif"===u.type&&(d="gif"),l.push({webPath:URL.createObjectURL(u),format:d})}e({photos:l}),o()}),t.addEventListener("cancel",i=>{r(new A("User cancelled photos app")),o()})),t.accept="image/*",t.click()}_getCameraPhoto(e,r){return new Promise((t,o)=>{const i=new FileReader,l=e.type.split("/")[1];"uri"===r.resultType?t({webPath:URL.createObjectURL(e),format:l,saved:!1}):(i.readAsDataURL(e),i.onloadend=()=>{const a=i.result;t("dataUrl"===r.resultType?{dataUrl:a,format:l,saved:!1}:{base64String:a.split(",")[1],format:l,saved:!1})},i.onerror=a=>{o(a)})})}checkPermissions(){var e=this;return(0,c.A)(function*(){if(typeof navigator>"u"||!navigator.permissions)throw e.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw e.unavailable("Camera permissions are not available in this browser")}})()}requestPermissions(){var e=this;return(0,c.A)(function*(){throw e.unimplemented("Not implemented on web.")})()}pickLimitedLibraryPhotos(){var e=this;return(0,c.A)(function*(){throw e.unavailable("Not implemented on web.")})()}getLimitedLibraryPhotos(){var e=this;return(0,c.A)(function*(){throw e.unavailable("Not implemented on web.")})()}}new X;const ue=S("Camera",{web:()=>new X});var Y=b(1626);let de=(()=>{var n;class e{constructor(t){this.http=t}takePhoto(){return(0,c.A)(function*(){try{return(yield ue.getPhoto({resultType:z.Base64,source:U.Camera,quality:100})).base64String}catch(t){return void console.error("Error taking photo",t)}})()}uploadPhoto(t,o){var i=this;return(0,c.A)(function*(){try{const l=new FormData;l.append("user_id",t.toString()),l.append("image",o);const a=yield i.http.post("http://20.37.211.153/finance-tracker/upload-profile-picture.php",l).toPromise();return!!a.success||(console.error("Failed to upload photo:",a.error),!1)}catch(l){return console.error("Error uploading photo",l),!1}})()}}return(n=e).\u0275fac=function(t){return new(t||n)(s.KVO(Y.Qq))},n.\u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();function fe(n,e){if(1&n){const r=s.RV6();s.j41(0,"ion-button",9),s.bIt("click",function(){s.eBV(r);const o=s.XpG();return s.Njj(o.confirmUpload())}),s.EFF(1,"Confirm Upload"),s.k0s()}}function pe(n,e){if(1&n){const r=s.RV6();s.j41(0,"ion-button",10),s.bIt("click",function(){s.eBV(r);const o=s.XpG();return s.Njj(o.cancelUpload())}),s.EFF(1,"Cancel"),s.k0s()}}const me=[{path:"",component:(()=>{var n;class e{constructor(t,o){this.photoService=t,this.http=o,this.defaultProfileImage="assets/default.png",this.showConfirmUpload=!1}ngOnInit(){var t=this;return(0,c.A)(function*(){t.userId=t.getUserIdFromLocalStorage(),t.userId?(yield t.loadProfilePicture(),yield t.getUsername()):(console.error("User ID not found in local storage."),t.photo=t.defaultProfileImage)})()}getUserIdFromLocalStorage(){const t=localStorage.getItem("userId");return t?+t:void 0}loadProfilePicture(){var t=this;return(0,c.A)(function*(){try{const o=yield t.http.get(`http://20.37.211.153/finance-tracker/get-profile-picture.php?user_id=${t.userId}`).toPromise();t.photo=o&&o.profile_image?"data:image/jpeg;base64,"+o.profile_image:t.defaultProfileImage}catch(o){console.error("Error loading profile picture:",o),t.photo=t.defaultProfileImage}})()}getUsername(){var t=this;return(0,c.A)(function*(){localStorage.getItem("userId")?t.http.get(`http://20.37.211.153/finance-tracker/get-user.php?user_id=${t.userId}`).subscribe(i=>{t.username=i.username||""},i=>{console.error("Error fetching username:",i)}):console.error("User ID not found in local storage")})()}takePicture(){var t=this;return(0,c.A)(function*(){t.showConfirmUpload=!1;const o=yield t.photoService.takePhoto();o&&(t.capturedPhoto=o,t.showConfirmUpload=!0)})()}confirmUpload(){var t=this;return(0,c.A)(function*(){t.capturedPhoto&&t.userId?(yield t.photoService.uploadPhoto(t.userId,t.capturedPhoto))&&(yield t.loadProfilePicture(),t.showConfirmUpload=!1):console.error("User ID or captured photo not available for upload.")})()}cancelUpload(){this.showConfirmUpload=!1}}return(n=e).\u0275fac=function(t){return new(t||n)(s.rXU(de),s.rXU(Y.Qq))},n.\u0275cmp=s.VBU({type:n,selectors:[["app-profile"]],decls:19,vars:5,consts:[["slot","start"],["defaultHref","/expense-tracker",2,"color","white"],[2,"color","white"],[1,"ion-padding"],[1,"profile-picture"],[3,"src"],["expand","block",3,"click"],["expand","block","class","confirm-button",3,"click",4,"ngIf"],["expand","block","class","cancel-button",3,"click",4,"ngIf"],["expand","block",1,"confirm-button",3,"click"],["expand","block",1,"cancel-button",3,"click"]],template:function(t,o){1&t&&(s.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),s.nrm(3,"ion-back-button",1),s.k0s(),s.j41(4,"ion-title",2),s.EFF(5," Profile "),s.k0s()()(),s.j41(6,"ion-content",3)(7,"ion-avatar",4),s.nrm(8,"ion-img",5),s.k0s(),s.j41(9,"ion-item")(10,"ion-label",2),s.EFF(11),s.k0s()(),s.j41(12,"ion-item")(13,"ion-label",2),s.EFF(14),s.k0s()(),s.j41(15,"ion-button",6),s.bIt("click",function(){return o.takePicture()}),s.EFF(16,"Upload Picture"),s.k0s(),s.DNE(17,fe,2,0,"ion-button",7)(18,pe,2,0,"ion-button",8),s.k0s()),2&t&&(s.R7$(8),s.Y8G("src",o.photo),s.R7$(3),s.SpI("Username: ",o.username,""),s.R7$(3),s.SpI("User id: ",o.userId,""),s.R7$(3),s.Y8G("ngIf",o.showConfirmUpload),s.R7$(),s.Y8G("ngIf",o.showConfirmUpload))},dependencies:[G.bT,g.mC,g.Jm,g.QW,g.W9,g.eU,g.KW,g.uz,g.he,g.BC,g.ai,g.el],styles:[".profile-picture[_ngcontent-%COMP%]{--size: 150px;width:150px;height:150px;margin:0 auto;display:block;border-radius:50%;overflow:hidden}.profile-picture[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.confirm-button[_ngcontent-%COMP%]{--background: #4CAF50;--color: #ffffff}.cancel-button[_ngcontent-%COMP%]{--background: #F44336;--color: #ffffff}.captured-photo-preview[_ngcontent-%COMP%]{max-width:100px;max-height:100px;margin-top:10px}.gray-text[_ngcontent-%COMP%]{color:#f0f0f0}ion-item[_ngcontent-%COMP%]{--background: #212121;--ion-color-base: #303030}"]}),e})()}];let he=(()=>{var n;class e{}return(n=e).\u0275fac=function(t){return new(t||n)},n.\u0275mod=s.$C({type:n}),n.\u0275inj=s.G2t({imports:[B.iI.forChild(me),B.iI]}),e})(),ge=(()=>{var n;class e{}return(n=e).\u0275fac=function(t){return new(t||n)},n.\u0275mod=s.$C({type:n}),n.\u0275inj=s.G2t({imports:[G.MD,Z.YN,g.bv,he]}),e})()}}]);