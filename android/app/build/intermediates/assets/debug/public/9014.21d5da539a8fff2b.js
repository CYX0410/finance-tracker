"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9014],{9014:(E,d,c)=>{c.r(d),c.d(d,{ExpenseTrackerPageModule:()=>P});var u=c(177),p=c(4341),a=c(9465),g=c(8986),n=c(3953),f=c(1626);function _(o,s){1&o&&n.nrm(0,"ion-spinner")}function m(o,s){if(1&o){const r=n.RV6();n.j41(0,"ion-item")(1,"ion-label")(2,"h2",0),n.EFF(3),n.k0s(),n.j41(4,"p",0),n.EFF(5),n.k0s(),n.j41(6,"p",0),n.EFF(7),n.nI1(8,"date"),n.k0s(),n.j41(9,"p",0),n.EFF(10),n.k0s(),n.j41(11,"p",0),n.EFF(12),n.k0s()(),n.j41(13,"ion-buttons",1)(14,"ion-button",21),n.bIt("click",function(){const t=n.eBV(r).$implicit,i=n.XpG(3);return n.Njj(i.editTransaction(t.id))}),n.nrm(15,"i",22),n.k0s(),n.j41(16,"ion-button",23),n.bIt("click",function(){const t=n.eBV(r).$implicit,i=n.XpG(3);return n.Njj(i.deleteTransaction(t.id))}),n.nrm(17,"i",24),n.k0s()()()}if(2&o){const r=s.$implicit;n.R7$(3),n.SpI("Amount: ",r.amount," MYR"),n.R7$(2),n.SpI("Category: ",r.category,""),n.R7$(2),n.SpI("Date: ",n.i5U(8,5,r.date,"mediumDate"),""),n.R7$(3),n.SpI("Notes: ",r.notes,""),n.R7$(2),n.SpI("Location: ",r.location,"")}}function b(o,s){if(1&o&&(n.qex(0),n.j41(1,"ion-list",20)(2,"ion-item-divider")(3,"ion-label"),n.EFF(4),n.k0s()(),n.DNE(5,m,18,8,"ion-item",19),n.j41(6,"ion-item")(7,"ion-label",0)(8,"strong"),n.EFF(9),n.k0s()()()(),n.bVm()),2&o){const r=s.$implicit,e=n.XpG(2);n.R7$(4),n.JRh(r.key),n.R7$(),n.Y8G("ngForOf",r.value),n.R7$(4),n.SpI("Total: ",e.getTotalAmount(r.value)," MYR")}}function k(o,s){if(1&o&&(n.qex(0),n.DNE(1,b,10,3,"ng-container",19),n.nI1(2,"keyvalue"),n.bVm()),2&o){const r=n.XpG();n.R7$(),n.Y8G("ngForOf",n.bMT(2,1,r.filteredTransactionsByMonth))}}function T(o,s){1&o&&(n.j41(0,"ion-item")(1,"ion-label",0),n.EFF(2," No transactions recorded yet. "),n.k0s()())}const x=[{path:"",component:(()=>{var o;class s{constructor(e,t,i){this.router=e,this.route=t,this.http=i,this.username="",this.transactions=[],this.transactionsByMonth={},this.loading=!0,this.searchCategory="",this.filteredTransactionsByMonth={}}ngOnInit(){this.getUsername(),this.router.events.subscribe(e=>{e instanceof g.wF&&(console.log("Navigation ended:",e.url),this.refreshTransactionsIfNecessary(e.url))}),this.route.queryParams.subscribe(e=>{e.refresh&&this.refreshTransactions()})}getUsername(){const e=localStorage.getItem("userId");e?this.http.get(`http://20.37.211.153/finance-tracker/get-user.php?user_id=${e}`).subscribe(t=>{this.username=t.username||"",this.getTransactions(parseInt(e,10))},t=>{console.error("Error fetching username:",t)}):console.error("User ID not found in local storage")}getTransactions(e){this.loading=!0,this.http.get(`http://20.37.211.153/finance-tracker/get-transaction.php?user_id=${e}`).subscribe(t=>{this.transactions=t,this.transactionsByMonth=this.groupTransactionsByMonth(t),this.filteredTransactionsByMonth=this.transactionsByMonth,this.loading=!1},t=>{console.error("Error fetching transactions:",t),this.loading=!1})}groupTransactionsByMonth(e){const t={};return e.forEach(i=>{const l=new Date(i.date),h=l.toLocaleString("default",{month:"long"})+" "+l.getFullYear();t[h]||(t[h]=[]),t[h].push(i)}),t}getTotalAmount(e){return e.reduce((t,i)=>t+Number(i.amount),0)}refreshTransactionsIfNecessary(e){(e.includes("/add-transaction")||e.includes("/edit-transaction"))&&(console.log("Refreshing transactions..."),this.refreshTransactions())}filterTransactions(){const e=this.searchCategory.toLowerCase();this.filteredTransactionsByMonth={},Object.keys(this.transactionsByMonth).forEach(t=>{const i=this.transactionsByMonth[t].filter(l=>l.category.toLowerCase().includes(e));i.length>0&&(this.filteredTransactionsByMonth[t]=i)})}addTransaction(){this.router.navigate(["/add-transaction"])}editTransaction(e){this.router.navigate([`/edit-transaction/${e}`])}deleteTransaction(e){confirm("Are you sure you want to delete this transaction?")&&this.http.delete(`http://20.37.211.153/finance-tracker/delete-transaction.php?transaction_id=${e}`).subscribe(()=>{this.transactions=this.transactions.filter(t=>t.id!==e),this.transactionsByMonth=this.groupTransactionsByMonth(this.transactions),this.filterTransactions()},t=>{console.error("Error deleting transaction:",t)})}goToProfile(){this.router.navigate(["/profile"])}refreshTransactions(){const e=localStorage.getItem("userId");e&&this.getTransactions(parseInt(e,10))}goToExpenseChart(){this.router.navigate(["/expense-chart"])}logout(){localStorage.removeItem("userId"),this.router.navigate(["/login"])}}return(o=s).\u0275fac=function(e){return new(e||o)(n.rXU(g.Ix),n.rXU(g.nX),n.rXU(f.Qq))},o.\u0275cmp=n.VBU({type:o,selectors:[["app-expense-tracker"]],decls:37,vars:5,consts:[[2,"color","white"],["slot","end"],[3,"click"],["id","profile-icon",1,"bi","bi-person-circle"],["id","logout-icon",1,"bi","bi-box-arrow-right"],[1,"ion-padding"],[1,"greetings"],["placeholder","Search by category",3,"ngModelChange","ionInput","ngModel"],[1,"button-row"],["expand","block",1,"menu-button",3,"click"],["src","assets/icon/addTransaction.png"],["expand","block","routerLink","/currency-calculator",1,"menu-button"],["src","assets/icon/currencyCalculator.png"],["expand","block","routerLink","/expense-chart",1,"menu-button"],["src","assets/icon/generateChart.png"],[1,"expenses-header"],[1,"refresh-button",3,"click"],["src","assets/icon/refresh.png",1,"refresh-icon"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"background-color","black"],["color","primary",3,"click"],["id","editDelete-icon",1,"bi","bi-pen"],["color","danger",3,"click"],["id","editDelete-icon",1,"bi","bi-trash-fill"]],template:function(e,t){1&e&&(n.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title",0),n.EFF(3," Expense Tracker "),n.k0s(),n.j41(4,"ion-buttons",1)(5,"ion-button",2),n.bIt("click",function(){return t.goToProfile()}),n.nrm(6,"i",3),n.k0s(),n.j41(7,"ion-button",2),n.bIt("click",function(){return t.logout()}),n.nrm(8,"i",4),n.k0s()()()(),n.j41(9,"ion-content",5)(10,"div",6)(11,"h4",0),n.EFF(12,"Welcome"),n.k0s(),n.j41(13,"h1",0),n.EFF(14),n.k0s()(),n.j41(15,"ion-searchbar",7),n.mxI("ngModelChange",function(l){return n.DH7(t.searchCategory,l)||(t.searchCategory=l),l}),n.bIt("ionInput",function(){return t.filterTransactions()}),n.k0s(),n.j41(16,"div",8)(17,"ion-button",9),n.bIt("click",function(){return t.addTransaction()}),n.nrm(18,"img",10),n.j41(19,"ion-label",0),n.EFF(20,"Add"),n.k0s()(),n.j41(21,"ion-button",11),n.nrm(22,"img",12),n.j41(23,"ion-label",0),n.EFF(24,"Convert"),n.k0s()(),n.j41(25,"ion-button",13),n.nrm(26,"img",14),n.j41(27,"ion-label",0),n.EFF(28,"Chart"),n.k0s()()(),n.j41(29,"div",15)(30,"h5",0),n.EFF(31,"List of Expenses"),n.k0s(),n.j41(32,"ion-button",16),n.bIt("click",function(){return t.refreshTransactions()}),n.nrm(33,"img",17),n.k0s()(),n.DNE(34,_,1,0,"ion-spinner",18)(35,k,3,3,"ng-container",18)(36,T,3,0,"ion-item",18),n.k0s()),2&e&&(n.R7$(14),n.JRh(t.username),n.R7$(),n.R50("ngModel",t.searchCategory),n.R7$(19),n.Y8G("ngIf",t.loading),n.R7$(),n.Y8G("ngIf",!t.loading&&t.filteredTransactionsByMonth),n.R7$(),n.Y8G("ngIf",!t.loading&&0===t.transactions.length))},dependencies:[u.Sq,u.bT,p.BC,p.vS,a.Jm,a.QW,a.W9,a.eU,a.uz,a.Dg,a.he,a.nf,a.S1,a.w2,a.BC,a.ai,a.Gw,a.N7,g.Wk,u.vh,u.lG],styles:["#profile-icon[_ngcontent-%COMP%], #logout-icon[_ngcontent-%COMP%]{font-size:24px;margin-right:5px;color:#fff}.button-row[_ngcontent-%COMP%]{background-color:#3030;border-radius:10px;padding:5px;margin:20px 10px;display:flex;justify-content:space-between}.menu-button[_ngcontent-%COMP%]{height:105px;display:flex;flex-direction:column;align-items:center;justify-content:center;flex:1;--background: #424242;--border-radius: 10px;--box-shadow: 3px 4px 4px hsl(0deg 0% 0% / .38)}.menu-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:50px;position:absolute;top:10%}.menu-button[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:15px;font-weight:700;color:#f0f0f0;text-transform:none;position:absolute;top:80%}.greetings[_ngcontent-%COMP%]{padding-left:20px}.greetings[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-top:-2px}.greetings[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-weight:700}.expenses-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin:5px 10px}.expenses-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-weight:700;margin:0}.refresh-button[_ngcontent-%COMP%]{--background: #424242;--box-shadow: 3px 4px 4px hsl(0deg 0% 0% / .38)}.refresh-icon[_ngcontent-%COMP%]{height:25px;width:25px}#editDelete-icon[_ngcontent-%COMP%]{font-size:20px}[_nghost-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{--background: #424242;--color: #fff;--placeholder-color: #f0f0f0;--icon-color: #f0f0f0;--clear-icon-color: #f0f0f0;--border-radius: 20px;--box-shadow: 3px 4px 4px hsl(0deg 0% 0% / .38)}.list-date[_ngcontent-%COMP%]{--background: #111111}.white-text[_ngcontent-%COMP%]{color:#fff}ion-item[_ngcontent-%COMP%]{--background: #303030;--ion-color-base: #212121}ion-item-divider[_ngcontent-%COMP%]{background-color:#000;color:#5c5a5a}"]}),s})()}];let M=(()=>{var o;class s{}return(o=s).\u0275fac=function(e){return new(e||o)},o.\u0275mod=n.$C({type:o}),o.\u0275inj=n.G2t({imports:[g.iI.forChild(x),g.iI]}),s})(),P=(()=>{var o;class s{}return(o=s).\u0275fac=function(e){return new(e||o)},o.\u0275mod=n.$C({type:o}),o.\u0275inj=n.G2t({imports:[u.MD,p.YN,a.bv,M]}),s})()}}]);